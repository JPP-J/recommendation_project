Example Result:
----------------------------------------------------------------------------------------------------------------
> main.py
Original data shape: (113518, 3)
Columns: ['user_id' 'book_id' 'rating']
Sampling data shape: (90814, 3)

Generating recommendations for user_id: 172

User-based CF recommendations: [2857, 2988, 3151, 3378, 3897, 3969, 4745, 4880, 6487, 6625]
Item-based CF recommendations: [202, 1398, 1667, 2267, 2283, 2319, 2428, 2580, 2916, 2940]
User KNN recommendations: [110, 1, 25, 39, 135, 17, 23, 20, 69, 141]
Item KNN recommendations: [8159, 4, 5, 8, 10, 23, 25, 36, 38, 47]

Evaluation Metrics:
precision@5_cf_user: 0.0004
precision@5_cf_item: 0.0004
precision@5_knn_user: 0.1524
precision@5_knn_item: 0.0148
precision@10_cf_user: 0.0004
precision@10_cf_item: 0.0003
precision@10_knn_user: 0.1314
precision@10_knn_item: 0.0130
precision@15_cf_user: 0.0005
precision@15_cf_item: 0.0003
precision@15_knn_user: 0.1153
precision@15_knn_item: 0.0122

----------------------------------------------------------------------------------------------------------------
> main2.py (Using spark and Hadoop to build model)
>> df_parquet()      # Read Parquet from HDFS
+-------+-------+------+
|user_id|book_id|rating|
+-------+-------+------+
|  52898|     61|     5|
|  52898|   1920|     1|
|  52898|   1212|     3|
|  52898|    262|     4|
|  52898|    979|     3|
+-------+-------+------+
only showing top 5 rows

+------+-------+
|rating|  count|
+------+-------+
|     1| 124195|
|     3|1370916|
|     5|1983093|
|     4|2139018|
|     2| 359257|
+------+-------+

+--------+
|count(1)|
+--------+
| 5976479|
+--------+
----------------------------------------------------------------------------------------------------------------


>> def train_test()
+-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|user_id|recommendations                                                                                                                                                                            |     
+-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+     
|28     |[{3628, 4.9427667}, {7947, 4.895723}, {6920, 4.8575983}, {8946, 4.856577}, {3491, 4.855869}, {6590, 4.85543}, {9566, 4.8477054}, {6361, 4.8330297}, {7254, 4.831881}, {8978, 4.830695}]    |     
|31     |[{3628, 4.164118}, {9566, 4.09175}, {6590, 4.0829225}, {6920, 4.065758}, {8548, 4.0526543}, {8946, 4.035296}, {8187, 4.0342116}, {7401, 4.026385}, {5580, 4.025942}, {8978, 4.024383}]     |     
|34     |[{8946, 4.755716}, {7254, 4.5031357}, {7844, 4.4627542}, {9566, 4.447623}, {3628, 4.4432216}, {6590, 4.439726}, {4483, 4.4315963}, {8978, 4.4269342}, {5207, 4.4236665}, {6920, 4.40517}]  |     
|53     |[{8946, 4.2143545}, {7537, 3.812152}, {7988, 3.789846}, {9566, 3.7349584}, {9842, 3.7171407}, {8926, 3.698518}, {4154, 3.6717799}, {1198, 3.6646757}, {8548, 3.6604605}, {6590, 3.651}]    |     
|65     |[{8946, 5.2642217}, {3628, 5.172176}, {9566, 5.135312}, {6920, 5.130901}, {8109, 5.0883465}, {6527, 5.0881553}, {6590, 5.0719876}, {2767, 5.0547147}, {3248, 5.0401697}, {5580, 5.0351915}]|     
+-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+     
only showing top 5 rows

+-------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|item_id|recommendations                                                                                                                                                                                  
   |
+-------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|28     |[{17923, 4.9105005}, {41903, 4.8562775}, {48787, 4.8466654}, {41383, 4.843054}, {48687, 4.8322096}, {41026, 4.8278217}, {22895, 4.8172817}, {51524, 4.813125}, {38451, 4.812446}, {10909, 4.806289}]|
|31     |[{38076, 5.873941}, {51626, 5.7510386}, {46750, 5.621944}, {46343, 5.619133}, {46318, 5.6188574}, {9514, 5.617732}, {40668, 5.60813}, {51456, 5.5976896}, {30245, 5.5926003}, {44436, 5.5898676}]   |
|34     |[{48606, 5.348406}, {38076, 5.2845855}, {40659, 5.241196}, {52786, 5.0446963}, {44844, 4.982867}, {39974, 4.981898}, {31701, 4.9710402}, {47360, 4.967605}, {35600, 4.9628024}, {32039, 4.950306}]  |
|53     |[{38076, 5.1679926}, {26305, 4.941578}, {48681, 4.9286556}, {41783, 4.9281015}, {40093, 4.924172}, {11849, 4.921524}, {8549, 4.9197407}, {12099, 4.9145885}, {49688, 4.912705}, {47547, 4.9071774}] |
|65     |[{13483, 5.2588434}, {3556, 5.1833005}, {41383, 5.150948}, {19474, 5.139741}, {25017, 5.13868}, {41977, 5.082369}, {31888, 5.079473}, {11566, 5.0714536}, {30612, 5.0705957}, {43800, 5.0682497}]   |
+-------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
only showing top 5 rows


----------------------------------------------------------------------------------------------------------------
>> def evaluate_model()

+-------+------------------------------------------------------------+
|user_id|recommended_items                                           |
+-------+------------------------------------------------------------+
|28     |[8946, 3628, 3491, 9566, 6590, 6920, 7947, 6361, 5207, 5580]|
|31     |[8946, 3628, 9566, 6590, 6920, 8187, 6361, 8978, 5580, 3491]|
|34     |[8946, 3628, 7254, 7844, 6920, 5207, 6590, 9566, 4483, 6361]|
|53     |[8946, 9566, 3628, 9531, 3395, 6590, 3660, 3082, 6384, 6920]|
|65     |[8946, 3628, 9460, 9566, 6920, 6590, 7844, 1788, 8978, 6298]|
+-------+------------------------------------------------------------+
only showing top 5 rows

+-------+--------------------+
|user_id|          true_items|
+-------+--------------------+
|     12|[3870, 9, 336, 46...|
|     26|[284, 6064, 104, ...|
|     27|[3849, 7543, 2441...|
|     28|[233, 661, 1, 372...|
|     31|[1, 31, 2615, 241...|
+-------+--------------------+
only showing top 5 rows

+-------+--------------------+--------------------+
|user_id|   recommended_items|          true_items|
+-------+--------------------+--------------------+
|     28|[8946, 3628, 3491...|[233, 661, 1, 372...|
|     31|[8946, 3628, 9566...|[1, 31, 2615, 241...|
|     34|[8946, 3628, 7254...|[1199, 967, 408, ...|
|     53|[8946, 9566, 3628...|[63, 1664, 4862, ...|
|     65|[8946, 3628, 9460...|[488, 1389, 612, ...|
+-------+--------------------+--------------------+
only showing top 5 rows

+-------+--------------------+--------------------+--------------------+--------------+
|user_id|     recommendations|   recommended_items|          true_items|precision_at_k|
+-------+--------------------+--------------------+--------------------+--------------+
|     28|[{8946, 4.968645}...|[8946, 3628, 3491...|[233, 661, 1, 372...|           0.0|
|     31|[{8946, 4.243522}...|[8946, 3628, 9566...|[1, 31, 2615, 241...|           0.0|
|     34|[{8946, 4.749324}...|[8946, 3628, 7254...|[1199, 967, 408, ...|           0.1|
|     53|[{8946, 3.829628}...|[8946, 9566, 3628...|[63, 1664, 4862, ...|           0.0|
|     65|[{8946, 5.093122}...|[8946, 3628, 9460...|[488, 1389, 612, ...|           0.0|
+-------+--------------------+--------------------+--------------------+--------------+
only showing top 5 rows

+-------+--------------+
|user_id|precision_at_k|
+-------+--------------+
|28     |0.0           |
|31     |0.0           |
|34     |0.1           |
|53     |0.0           |
|65     |0.0           | 
|78     |0.0           |
|81     |0.0           |
|85     |0.0           |
|101    |0.0           |
|108    |0.0           |
+-------+--------------+
only showing top 10 rows
----------------------------------------------------------------------------------------------------------------